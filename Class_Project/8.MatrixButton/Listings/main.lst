C51 COMPILER V9.54   MAIN                                                                  10/01/2025 15:06:36 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Objects\main.obj
COMPILER INVOKED BY: D:\Keil_v5\C51\BIN\C51.EXE main.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listings\main
                    -.lst) OBJECT(.\Objects\main.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          unsigned char SelectTube[20] = {0x3F,0x06,0x5B,0x4F,0x66,0x6D,0x7D,0x07,0x7F,0x6F};
   4          
   5          void Delay(int time)    //@11.0592MHz
   6          {
   7   1              while(time--){
   8   2                      unsigned char data i, j;
   9   2      
  10   2                      i = 11;
  11   2                      j = 190;
  12   2                      do
  13   2                      {
  14   3                              while (--j);
  15   3                      } while (--i);
  16   2              }
  17   1      }
  18          
  19          void Select(unsigned char Location,Num){
  20   1      
  21   1              switch(Location){
  22   2                      case 1: P2_4=1;P2_3=1;P2_2=1;break;
  23   2                      case 2: P2_4=1;P2_3=1;P2_2=0;break;
  24   2                      case 3: P2_4=1;P2_3=0;P2_2=1;break;
  25   2                      case 4: P2_4=1;P2_3=0;P2_2=0;break;
  26   2                      case 5: P2_4=0;P2_3=1;P2_2=1;break;
  27   2                      case 6: P2_4=0;P2_3=1;P2_2=0;break;
  28   2                      case 7: P2_4=0;P2_3=0;P2_2=1;break;
  29   2                      case 8: P2_4=0;P2_3=0;P2_2=0;break;
  30   2              }
  31   1              
  32   1              P0 = SelectTube[Num];            
  33   1              // P0 = 0x00;
  34   1      }
  35          
  36          unsigned char scanning(){
  37   1              // 扫描第一列
  38   1              P1 = 0xFF;
  39   1              P1_3 = 0;
  40   1              if(P1_7==0){Delay(20);while(P1_7==0);Delay(20);return 1;}
  41   1              if(P1_6==0){Delay(20);while(P1_7==0);Delay(20);return 5;}
  42   1              if(P1_5==0){Delay(20);while(P1_7==0);Delay(20);return 9;}
  43   1              if(P1_4==0){Delay(20);while(P1_7==0);Delay(20);return 13;}
  44   1              
  45   1              // 扫描第二列
  46   1              P1 = 0xFF;
  47   1              P1_2 = 0;
  48   1              if(P1_7==0){Delay(20);while(P1_7==0);Delay(20);return 2;}
  49   1              if(P1_6==0){Delay(20);while(P1_7==0);Delay(20);return 6;}
  50   1              if(P1_5==0){Delay(20);while(P1_7==0);Delay(20);return 10;}
  51   1              if(P1_4==0){Delay(20);while(P1_7==0);Delay(20);return 14;}
  52   1              
  53   1              // 扫描第三列
  54   1              P1 = 0xFF;
C51 COMPILER V9.54   MAIN                                                                  10/01/2025 15:06:36 PAGE 2   

  55   1              P1_1 = 0;
  56   1              if(P1_7==0){Delay(20);while(P1_7==0);Delay(20);return 3;}
  57   1              if(P1_6==0){Delay(20);while(P1_7==0);Delay(20);return 7;}
  58   1              if(P1_5==0){Delay(20);while(P1_7==0);Delay(20);return 11;}
  59   1              if(P1_4==0){Delay(20);while(P1_7==0);Delay(20);return 13;}
  60   1      
  61   1              // 扫描第四列
  62   1              P1 = 0xFF;
  63   1              P1_0 = 0;
  64   1              if(P1_7==0){Delay(20);while(P1_7==0);Delay(20);return 4;}
  65   1              if(P1_6==0){Delay(20);while(P1_7==0);Delay(20);return 8;}
  66   1              if(P1_5==0){Delay(20);while(P1_7==0);Delay(20);return 12;}
  67   1              if(P1_4==0){Delay(20);while(P1_7==0);Delay(20);return 16;}
  68   1              
  69   1              return 0;
  70   1      }
  71          
  72          void main(){
  73   1              while(1){
  74   2                      unsigned char keynum = scanning();
  75   2                      if(keynum){
  76   3                              Select(1, keynum);
  77   3                      }
  78   2              }
  79   1      }
  80          
  81          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    407    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     20       3
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
